<div class="container">
    <!-- Breadcrumb -->
    <nav aria-label="breadcrumb" class="mb-4">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="/">Home</a></li>
            <li class="breadcrumb-item"><a href="/recipes/dashboard">Dashboard</a></li>
            <li class="breadcrumb-item active">My Profile</li>
        </ol>
    </nav>
    
    <div class="row">
        <!-- Left Column: Profile Info -->
        <div class="col-lg-4 mb-4">
            <!-- Profile Card -->
            <div class="card shadow-sm border-success">
                <div class="card-body text-center">
                    <!-- Avatar -->
                    <div class="mb-4">
                        <img src="{{user.avatar}}" 
                             alt="{{user.displayName}}" 
                             class="rounded-circle border border-4 border-success"
                             width="150" height="150"
                             onerror="this.src='/images/default-avatar.png'">
                    </div>
                    
                    <!-- User Info -->
                    <h2 class="h4 fw-bold text-success">{{user.displayName}}</h2>
                    <p class="text-muted mb-1">
                        <i class="fas fa-user me-2"></i>@{{user.username}}
                    </p>
                    <p class="text-muted mb-3">
                        <i class="fas fa-envelope me-2"></i>{{user.email}}
                    </p>
                    
                    <!-- Member Since -->
                    <div class="card bg-light mb-3">
                        <div class="card-body py-2">
                            <small class="text-muted">
                                <i class="fas fa-calendar-alt me-2"></i>
                                Member since {{formatDate user.createdAt}}
                            </small>
                        </div>
                    </div>
                    
                    <!-- Role Badge -->
                    <div class="mb-3">
                        <span class="badge bg-success">
                            <i class="fas fa-user-tag me-2"></i>
                            {{#if (eq user.role 'admin')}}Administrator{{else}}Member{{/if}}
                        </span>
                    </div>
                    
                    <!-- Stats -->
                    <div class="row text-center">
                        <div class="col-6">
                            <div class="border-end">
                                <h4 class="fw-bold text-success">{{recipes.length}}</h4>
                                <small class="text-muted">Recipes</small>
                            </div>
                        </div>
                        <div class="col-6">
                            <h4 class="fw-bold text-success">0</h4>
                            <small class="text-muted">Followers</small>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Quick Actions -->
            <div class="card shadow-sm mt-4">
                <div class="card-header bg-light">
                    <h6 class="mb-0"><i class="fas fa-bolt me-2"></i>Quick Actions</h6>
                </div>
                <div class="card-body">
                    <div class="d-grid gap-2">
                        <a href="/recipes/add/new" class="btn btn-outline-success">
                            <i class="fas fa-plus me-2"></i>Add Recipe
                        </a>
                        <a href="/recipes/dashboard" class="btn btn-outline-success">
                            <i class="fas fa-tachometer-alt me-2"></i>Dashboard
                        </a>
                        <a href="/recipes/public" class="btn btn-outline-success">
                            <i class="fas fa-search me-2"></i>Browse Recipes
                        </a>
                        <a href="/auth/logout" class="btn btn-outline-danger">
                            <i class="fas fa-sign-out-alt me-2"></i>Logout
                        </a>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Right Column: Profile Form & Recent Recipes -->
        <div class="col-lg-8">
            <!-- Edit Profile Form -->
            <div class="card shadow-sm mb-4">
                <div class="card-header bg-success text-white">
                    <h4 class="mb-0"><i class="fas fa-user-edit me-2"></i>Edit Profile</h4>
                </div>
                <div class="card-body">
                    <form action="/users/profile?_method=PUT" method="POST">
                        <div class="row g-3 mb-3">
                            <!-- Display Name -->
                            <div class="col-md-6">
                                <label for="displayName" class="form-label fw-bold">
                                    <i class="fas fa-id-card me-2"></i>Display Name
                                </label>
                                <input type="text" 
                                       class="form-control" 
                                       id="displayName" 
                                       name="displayName"
                                       value="{{user.displayName}}">
                                <div class="form-text">This name is visible to other users</div>
                            </div>
                            
                            <!-- Email -->
                            <div class="col-md-6">
                                <label class="form-label fw-bold">
                                    <i class="fas fa-envelope me-2"></i>Email Address
                                </label>
                                <input type="email" 
                                       class="form-control" 
                                       value="{{user.email}}"
                                       disabled>
                                <div class="form-text">Contact support to change email</div>
                            </div>
                        </div>
                        
                        <!-- Bio -->
                        <div class="mb-3">
                            <label for="bio" class="form-label fw-bold">
                                <i class="fas fa-pen me-2"></i>Bio
                            </label>
                            <textarea class="form-control" 
                                      id="bio" 
                                      name="bio"
                                      rows="4"
                                      placeholder="Tell us about yourself, your cooking style, or favorite dishes...">{{user.bio}}</textarea>
                            <div class="form-text">Maximum 500 characters</div>
                        </div>
                        
                        <!-- Avatar URL -->
                        <div class="mb-4">
                            <label for="avatar" class="form-label fw-bold">
                                <i class="fas fa-image me-2"></i>Avatar URL
                            </label>
                            <input type="url" 
                                   class="form-control" 
                                   id="avatar" 
                                   value="{{user.avatar}}"
                                   disabled>
                            <div class="form-text">
                                {{#if user.githubId}}
                                <i class="fab fa-github me-2"></i>GitHub avatar - update on GitHub
                                {{else}}
                                Default avatar - upload not available yet
                                {{/if}}
                            </div>
                        </div>
                        
                        <!-- Submit Button -->
                        <div class="d-grid">
                            <button type="submit" class="btn btn-success btn-lg">
                                <i class="fas fa-save me-2"></i>Save Changes
                            </button>
                        </div>
                    </form>
                </div>
            </div>
            
            <!-- Recent Recipes -->
            <div class="card shadow-sm">
                <div class="card-header bg-success text-white">
                    <div class="d-flex justify-content-between align-items-center">
                        <h4 class="mb-0">
                            <i class="fas fa-utensils me-2"></i>My Recent Recipes
                        </h4>
                        <a href="/recipes/dashboard" class="btn btn-light btn-sm">
                            View All <i class="fas fa-arrow-right ms-1"></i>
                        </a>
                    </div>
                </div>
                <div class="card-body">
                    {{#if recipes.length}}
                    <div class="table-responsive">
                        <table class="table table-hover">
                            <thead>
                                <tr>
                                    <th>Recipe</th>
                                    <th>Category</th>
                                    <th>Views</th>
                                    <th>Created</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                {{#each recipes}}
                                <tr>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <img src="{{this.imageUrl}}" 
                                                 alt="{{this.title}}" 
                                                 class="rounded me-3" 
                                                 width="40" height="40"
                                                 style="object-fit: cover;"
                                                 onerror="this.src='/images/recipe-default.jpg'">
                                            <div>
                                                <strong>{{this.title}}</strong><br>
                                                <small class="text-muted">{{truncate this.description 40}}</small>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <span class="badge bg-success">{{this.category}}</span>
                                    </td>
                                    <td>
                                        <i class="fas fa-eye text-muted me-1"></i>
                                        {{this.views}}
                                    </td>
                                    <td>
                                        <small class="text-muted">{{formatDate this.createdAt}}</small>
                                    </td>
                                    <td>
                                        <div class="btn-group btn-group-sm">
                                            <a href="/recipes/{{this._id}}" class="btn btn-outline-success">
                                                <i class="fas fa-eye"></i>
                                            </a>
                                            <a href="/recipes/{{this._id}}/edit" class="btn btn-outline-primary">
                                                <i class="fas fa-edit"></i>
                                            </a>
                                        </div>
                                    </td>
                                </tr>
                                {{/each}}
                            </tbody>
                        </table>
                    </div>
                    {{else}}
                    <!-- Empty State -->
                    <div class="text-center py-5">
                        <i class="fas fa-utensils fa-3x text-muted mb-3"></i>
                        <h5 class="text-muted">No Recipes Yet</h5>
                        <p class="text-muted mb-4">You haven't created any recipes yet</p>
                        <a href="/recipes/add/new" class="btn btn-success">
                            <i class="fas fa-plus me-2"></i>Create Your First Recipe
                        </a>
                    </div>
                    {{/if}}
                </div>
            </div>
            
            <!-- Account Information -->
            <div class="card shadow-sm mt-4">
                <div class="card-header bg-light">
                    <h6 class="mb-0"><i class="fas fa-info-circle me-2"></i>Account Information</h6>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6">
                            <ul class="list-unstyled">
                                <li class="mb-2">
                                    <strong>Username:</strong> {{user.username}}
                                </li>
                                <li class="mb-2">
                                    <strong>Email:</strong> {{user.email}}
                                </li>
                                <li class="mb-2">
                                    <strong>Account Type:</strong> 
                                    {{#if (eq user.role 'admin')}}Administrator{{else}}Regular User{{/if}}
                                </li>
                            </ul>
                        </div>
                        <div class="col-md-6">
                            <ul class="list-unstyled">
                                <li class="mb-2">
                                    <strong>Joined:</strong> {{formatDate user.createdAt}}
                                </li>
                                <li class="mb-2">
                                    <strong>Last Updated:</strong> {{formatDate user.updatedAt}}
                                </li>
                                <li class="mb-2">
                                    <strong>Login Method:</strong> 
                                    {{#if user.githubId}}
                                    <i class="fab fa-github me-2"></i>GitHub
                                    {{else}}
                                    <i class="fas fa-envelope me-2"></i>Email
                                    {{/if}}
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Custom CSS for Profile Page -->
<style>
    .card {
        border-radius: 10px;
        overflow: hidden;
    }
    
    .card-header {
        border-bottom: none;
    }
    
    .border-end {
        border-right: 1px solid #dee2e6 !important;
    }
    
    img.rounded-circle {
        object-fit: cover;
    }
    
    .table img {
        object-fit: cover;
    }
    
    .btn-group .btn {
        padding: 0.25rem 0.5rem;
    }
</style>